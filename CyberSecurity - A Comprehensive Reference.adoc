= CyberSecurity: A Comprehensive Reference
Doc Writer <smsharif@secunoid.com>
v1.62, 13th October, 2019
:numbered:
:sectnum:
:sectnumlevels: 5
:chapter-label:
:toc: right
:toclevels: 5
:docinfo:
:docinfo1:
:docinfo2:
:description: This document covers all aspects of cybersecurity
:keywords: cybersecurity, it security, blockchain
:imagesdir: images
:stylesheet:
:homepage: https://www.securityprivacyrisk.com
'''


<<<
== Overview
Everything in this world is centered around information, knowledge, which translates into a generic term _data_.  This data can be about individuals, places, or things.  Regardless of who or what it is about it is important to protect it.

=== Non-living Entities
Data about non living entities when modified leads to mis-information and currently in the digital age our ability to provide the authenticity of that data is very difficult.  If the source is trustworthy, then we deem it authentic, currently there are no mechanisms to ensure that the data has not been modified in between from when the trustworthy source released and to the time it got to you.

=== Living Entities
Data about living entities, especially us humans is very valuable.  With the devices we carry, and use in our daily lives, we are constantly producing data, every hour, every second of our lives. 

<<<
== Privacy
Centralization has very damaging impacts to a users privacy.  Once the user has provided their information to an entity, they are at entities' mercy for data protection.

Certain states want to keep 

Data that is being processed by the solution should care fully considered for:

. Data protection: Based on data classification ensure data is protected in storage and in transit.
. Data retention: Based on regulatory, and industry requirements,  data should be retained for 
. Data access & update: Allow end users ability to access their data and modify it as required.

Governments across the world are responding to the global cybersecurity crisis by creating new regulations that govern the way companies handle and store valuable consumer data. This includes important information such as personal identifications, banking and credit card numbers, and purchase history.

The European Union, in particular, has been a leader in this field. One of its pioneering efforts is the General Data Protection Regulations (GDPR) what was passed in 2016 and went into effect in Spring 2018. It impacts all companies that do business with European customers, regardless of where the company is located.

The GDPR requires that companies receive consent from consumers before processing data, collect and store data anonymously, and notify customers when their information has potentially been breached. It also requires large businesses to appoint a data privacy protection officer to oversee implementation of the regulations.

Furthermore, while the U.S. federal government has yet to create a set of strong data privacy protections, several states have drawn up their legislation, including Hawaii, Massachusetts, Maryland, Mississippi, New Mexico, and Washington.

However, the most important of these regulations come from California, the largest state in the country by population with nearly 40 million residents. The California Consumer Privacy Act (CCPA) goes into effect on January 1, 2020, and governs the way companies must store and secure data.

CCPA allows consumers to demand crucial information about their personal data held by corporations.

When requested, businesses must inform consumers about the type of personal data they possess, provide them with specific personal information collected in the previous year, and allow customers to request that their information not be shared with third parties. Companies will also have to delete customer data when requested.



<<<
== Data Protection

=== Password Strength
Brute force password cracking - the importance of using a long password with a mix of uppercase, lowercase and special characters.

Assuming an attacker has a reasonably fast connection and PC, the table is an estimate of the amount of time it would take to generate every possible combination of passwords for a given number of characters. After generating the list it's just a matter of time before the computer runs through all the possibilities – or gets shut down trying.

Pay particular attention to the difference between using only lowercase characters and using all possible characters (uppercase, lowercase, and special characters – like @#$%^&*). Adding just one capital letter and one asterisk would change the processing time for an 8 character password from 2.4 days to 2.1 centuries.

via Dan Williams (https://www.linkedin.com/in/ACoAAACDV6ABaDOtrduFQ5p-c5qgSka1HHTseAY/?lipi=urn%3Ali%3Apage%3Ad_flagship3_feed%3BxdsE5HnqTDulyw2QOn9mCw%3D%3D)

image::PasswordLengthComplexityCrackingTime.jpg[]

<<<
== Information Security    

<<<
== Security Organization
For Security to be taken seriously a security organization is mandatory, while the non operational team would report to the CISO , the operational structure can be based on two models:

. Centralized
. Distributed

In centralized operational model, all aspects of security operations are within the security organization, such as:

. User provisioning/deprovisioning
. Security Information & Event Management (SIEM)
. Security Operations Center
. Incident Response
. Firewall & Network Operations

In a decentralized operations model, the above aspects are managed by different business units with the security organization providing oversight in form of GRC.

=== Security Operations
A robust mechanism must be instituted to ensure all systems are baselined and any deviation from the baseline is reported to the SOC  for action.
All critical components must be monitored at all times, and SIEM   leveraged to discover anomalies and ensure they are addressed in a timely fashion.

=== Security Architecture

=== Security Development

=== Security Strategy

<<<

== Security Policy
Before any solution is implemented, a security policy must be created to ensure all the industry, regulatory,  and other compliance requirements are documented.  This document will provide the security requirements to ensure the deployment is secure. All the requirements should be very high level without delving into implementation details.

<<<
== Security Manual
This document goes into details on the how the security policy requirements must be implemented.  It can be one document, or multiple depending on the size of implementation.

<<<
== Security Standards
Standards are mandatory requirements that must be adhered to. Some of the standards to be considered are:

=== Windows Web Server Hardening

*Services*

* Unnecessary Windows services are disabled.
* Services are running with least-privileged accounts.
* FTP, SMTP, and NNTP services are disabled if they are not required.
* Telnet service is disabled.

*Protocols*

* WebDAV is disabled if not used by the application OR it is secured if it is required.
* TCP/IP stack is hardened
* NetBIOS and SMB are disabled (closes ports 137, 138, 139, and 445).

*Accounts*

* Unused accounts are removed from the server.
* Guest account is disabled.
* IUSR_MACHINE account is disabled if it is not used by the application.
* If your applications require anonymous access, a custom least-privileged anonymous account is created.
* The anonymous account does not have write access to Web content directories and cannot execute command-line tools.
Strong account and password policies are enforced for the server.
* Remote logons are restricted. (The “Access this computer from the network” user-right is removed from the Everyone group.)
* Accounts are not shared among administrators.
* Null sessions (anonymous logons) are disabled.
* Approval is required for account delegation.
* Users and administrators do not share accounts.
* No more than two accounts exist in the Administrators group.
* Administrators are required to log on locally OR the remote administration solution is secure.

*Files and Directories*

* Files and directories are contained on NTFS volumes
Web site content is located on a non-system NTFS volume.
* Log files are located on a non-system NTFS volume and not on the same volume where the Web site content resides.
* The Everyone group is restricted (no access to \WINNT\system32 or Web directories).
* Web site root directory has denied write ACE for anonymous Internet accounts.
* Content directories have deny write ACE for anonymous Internet accounts.
* Remote  administration application is removed
* Resource kit tools, utilities, and SDKs are removed.
* Sample applications are removed

*Shares*

* All unnecessary shares are removed (including default administration shares).
* Access to required shares is restricted (the Everyone group does not have access).
* Administrative shares (C$ and Admin$) are removed if they are not required (Microsoft Management Server (SMS) and Microsoft Operations Manager (MOM) require these shares).

*Ports*

* Internet-facing interfaces are restricted to port 80 (and 443 if SSL is used)
* Intranet traffic is encrypted (for example, with SSL) or restricted if you do not have a secure data center infrastructure.

*Registry*

* Remote registry access is restricted.
* SAM is secured (HKLM\System\CurrentControlSet\Control\LSA\NoLMHash).

*Auditing and Logging*

* Failed logon attempts are audited.
* IIS log files are relocated and secured.
* Log files are configured with an appropriate size depending on the application security requirement.
* Log files are regularly archived and analyzed.
* Access to the Metabase.bin file is audited.
* IIS is configured for W3C Extended log file format auditing.

*Server Certificates*

* Ensure certificate date ranges are valid.
* Only use certificates for their intended purpose (For example, the server certificate is not used for e-mail).
* Ensure the certificate’s public key is valid, all the way to a trusted root authority.
* Confirm that the certificate has not been revoked.

<<<
== Security Guidelines

<<<
== Application Security
The scope of application security would be the 


=== Code Analysis


=== Key Management

<<<
== System Security
All the servers that the distributed ledger platform runs on must be:

. Hardened
. Monitored for availability
. Intrusion Detection/Intrusion Protection mechanisms deployed to protect from attacks coupled with SIEM for proactive defense.
. Based on the security be in a DMZ 

<<<
== Vulnerability Management Program
Red team-blue team exercises take their name from their military antecedents. The idea is simple: One group of security pros — a red team — attacks something, and an opposing group — the blue team — defends it. Originally, the exercises were used by the military to test force-readiness.

=== Taxonomy
Taxonomy is important as it ensures industry standard terms are used when talking about vulnerabilities, threat actors, and reporting.

==== Attacks

image::TypesOfAttacks.jpg[]

==== Malware
A malware is any piece of software that was written with the intent of damaging devices, stealing data, and generally causing a mess. Viruses, Trojans, spyware, and ransomware are among the different kinds of malware.

Malware is often created by teams of hackers: usually, they’re just looking to make money, either by spreading the malware themselves or selling it to the highest bidder on the Dark Web. However, there can be other reasons for creating malware too — it can be used as a tool for protest, a way to test security, or even as weapons of war between governments.

image::TypesOfMalware.jpg[]

* *Adware* Though not always malicious in nature, aggressive advertising software can undermine your security just to serve you ads — which can give other malware an easy way in. Plus, let’s face it: pop-ups are really annoying.

* *Bots* Bots is a soft for roBot. Bots are usually controlled remotely and work as a network.

* *Keylogger* It is one of the most dangerous threats to a PC user's privacy. This type of malware installs itself as a result of clicking while browsing the Internet or downloading software. Keyloggers keep track of all of your keystrokes when you are using your PC and then transfers the information to a remote server. It is capable of recording all of your online conversations, emails, and password logins, as well as creating screenshots of all of your PC activity.

Keyloggers are not always in the form of malware or software; it can also be installed on your computer in the form of hardware through being placed between the plug on your keyboard and the entry port. Some keyloggers are legitimate applications such as those that record an employee's PC activity during work hours. Other keyloggers are in the form of malicious software that is designed to perform criminal activity.

* *Ransomware* This kind of malware typically locks down your computer and your files, and threatens to erase everything unless you pay a ransom.

* *Remote Access*

* *Rootkit*

* *Spyware* No surprise here — spyware is malware designed to spy on you. It hides in the background and takes notes on what you do online, including your passwords, credit card numbers, surfing habits, and more.

* *Trojans* This kind of malware disguises itself as legitimate software, or is hidden in legitimate software that has been tampered with. It tends to act discreetly and create backdoors in your security to let other malware in.

* *Virus* Like their biological namesakes, viruses attach themselves to clean files and infect other clean files. They can spread uncontrollably, damaging a system’s core functionality and deleting or corrupting files. They usually appear as an executable file (.exe)

* *Worm* Worms infect entire networks of devices, either local or across the internet, by using network interfaces. It uses each consecutively infected machine to infect others.

=== Vulnerability Assessment
Vulnerability Assessment is designed to find vulnerabilities and assess to ensure they are not false positives. The next step is to remediate the vulnerability by patching the system, reconfiguring it, or implementing other controls to reduce the risk. 

=== Penetration Testing
Penetration testing, or pen testing for short, is an authorized attack against your computer system to discover and exploit vulnerabilities.  This activity is also known as ethical hacking.  

Penetration testing is a technical control that is implemented to ensure the systems that are currently in production or are going to be production do not have any vulnerabilities that would allow threat vectors to exploit.

The Penetration Testing Execution Standard (PTES) provides the necessary guidelines on how to conduct penetration testing.  More information can be found here: http://www.pentest-standard.org/index.php/Main_Page 

Penetration Testing goes further than vulnerability assessment.  After a vulnerability is identified, the tester attempts to exploit a vulnerability. This can be done numerous ways and, once a vulnerability is exploited, a good tester will not stop. They will continue to find and exploit other vulnerabilities, chaining attacks together, to reach their goal. Each organization is different, so this goal may change, but usually includes access to Personally Identifiable Information (PII), Protected Health Information (PHI), and trade secrets. Sometimes this requires Domain Administrator access; often it does not or Domain Administrator is not enough.

Penetration testing involves following steps:
. Reconnaissance via open source intelligence (OSINT) gathering techniques.  IT does not involve probing any or your devices, but gathering as much information publicly available about your environment using internet sources. 
. Scanning your network to identify active devices
. Fingerprint active devices to identify operating system and applications installed
. Find vulnerabilities for the services running on your systems
. Exploiting those vulnerabilities
. Once the vulnerability has been exploited, further probing the system to seek valuable information such as PII (Personally Identifiable Information) etc.
. Try to further explore other systems on the network and exploit them if possible.
. Produce a report that identifies vulnerabilities, which ones were exploited, what was the outcome of exploitation and suggest high level remediation steps.

There are three approaches to Penetration Tests:
. Black Box: No knowledge of th infrastructure.
. White Box: Full knowledge of the infrastructure.
. Grey Box: Some knowledge of the infrastructure.

Penetration Tests can include following scopes:
. External
. Internal
. Web application
. Wireless
. Cloud
. Social

==== Penetration Testing Tools

===== Arpspoof

===== Burp Suite
Burp Suite is a web application testing tool

Use vulnerable web application from the OWASP site: https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project/Pages/Offline  

===== CherryTree
Chery Tree is a note taking app

===== Chisel

===== Crackmapexec

===== DIRB

DIRB is a Web Content Scanner. It looks for existing (and/or hidden) Web Objects. It basically works by launching a dictionary based attack against a web server and analyzing the response.

DIRB comes with a set of pre-configured attack wordlists for easy usage but you can use your custom wordlists. Also DIRB sometimes can be used as a classic CGI scanner, but remember is a content scanner not a vulnerability scanner.

DIRB main purpose is to help in professional web application auditing. Specially in security related testing. It covers some holes not covered by classic web vulnerability scanners. DIRB looks for specific web objects that other generic CGI scanners can’t look for. It doesn’t search vulnerabilities nor does it look for web contents that can be vulnerable.

Source: http://dirb.sourceforge.net/about.html
DIRB Homepage | Kali DIRB Repo

Author: The Dark Raver
License: GPLv2

https://tools.kali.org/web-applications/dirb 

===== Dirbuster

===== DNSSPOOF

===== Ettercap

===== Exiftool
shows exif data about a file.

===== Eyewitness

===== Evilarc
evilarc.py is an archiving tool that allows for folder manipulation.

===== Gobuster
Gobuster is a tool used to brute-force:

URIs (directories and files) in web sites.
DNS subdomains (with wildcard support).
Because I wanted:

something that didn’t have a fat Java GUI (console FTW).
to build something that just worked on the command line.
something that did not do recursive brute force.
something that allowed me to brute force folders and multiple extensions at once.
something that compiled to native on multiple platforms.
something that was faster than an interpreted script (such as Python).
something that didn’t require a runtime.
use something that was good with concurrency (hence Go).
to build something in Go that wasn’t totally useless.
Source: https://github.com/OJ/gobuster
Gobuster Homepage | Kali gobuster Repo

Author: OJ Reeves
License: Apache-2.0

===== Hashcat

===== HTTPROBE

first install go: apt install golang upx-ucl -y


===== Hydra

===== Impacket-secretsdump

===== Kali Linux

[horizontal]
Install ntpdate package:: sudo apt-get install ntpdate
Sync date & time with ntp source:: sudo ntpdate in.pool.ntp.org
Metasploit directory:: /usr/share/metssploit-framework
Update Metasploit::  apt update; apt install metasploit-framework
Install all the tools on Kali:: sudo apt-get install kali-linux-full
Kali Tools Listing:: https://en.kali.tools/all/
Update Kali:: sudo apt-get update; sudo apt-get dist-upgrade;sudo apt-get clean

===== Maltego

===== Metasploit

On Kali metasploit is in this directory: /usr/share/metssploit-framework

To Update metasploit: apt update; apt install metasploit-framework

Metasploit Online Database: https://www.rapid7.com/db/modules

===== Netcat

nc -lvnp 9001

===== Nikto
Nikto is an Open Source (GPL) web server scanner which performs comprehensive tests against web servers for multiple items, including over 6700 potentially dangerous files/programs, checks for outdated versions of over 1250 servers, and version specific problems on over 270 servers. It also checks for server configuration items such as the presence of multiple index files, HTTP server options, and will attempt to identify installed web servers and software. Scan items and plugins are frequently updated and can be automatically updated.

Nikto is not designed as a stealthy tool. It will test a web server in the quickest time possible, and is obvious in log files or to an IPS/IDS. However, there is support for LibWhisker's anti-IDS methods in case you want to give it a try (or test your IDS system).


Not every check is a security problem, though most are. There are some items that are "info only" type checks that look for things that may not have a security flaw, but the webmaster or security engineer may not know are present on the server. These items are usually marked appropriately in the information printed. There are also some checks for unknown items which have been seen scanned for in log files.

https://cirt.net/Nikto2 

===== NESSUS

===== NMAP

===== Responder
does LLMNR Poisioning

===== Sbmclient

===== Smbmap

===== SSLStrip

===== Sublist3r
Sublist3r is a python tool designed to enumerate subdomains of websites using OSINT. It helps penetration testers and bug hunters collect and gather subdomains for the domain they are targeting. Sublist3r enumerates subdomains using many search engines such as Google, Yahoo, Bing, Baidu, and Ask. Sublist3r also enumerates subdomains using Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS.

Source: https://github.com/aboul3la/Sublist3r
Sublist3r Homepage | Kali sublist3r Repo

Author: Ahmed Aboul-Ela
License: GPL-2+

First open a terminal sessions and change the directory to the Desktop as following:

cd Desktop

The next step is to run the following command to clone the repository in a new directory:

git clone https://github.com/aboul3la/Sublist3r.git

Change the directory to Sublist3r:

cd Sublist3r

And finally complete the installation by installing the required dependencies with the following command:

pip install -r requirements.txt

python sublist3r -h

===== TheHarvester

===== Yara


==== Red team Assessment
A Red Team Assessment is similar to a penetration test in many ways but is more targeted. The goal of the Red Team Assessment is NOT to find as many vulnerabilities as possible. The goal is to test the organization's detection and response capabilities. The red team will try to get in and access sensitive information in any way possible, as quietly as possible. The Red Team Assessment emulates a malicious actor targeting attacks and looking to avoid detection, similar to an Advanced Persistent Threat (APT). (Ugh! I said it…) Red Team Assessments are also normally longer in duration than Penetration Tests. A Penetration Test often takes place over 1-2 weeks, whereas a Red Team Assessment could be over 3-4 weeks or longer, and often consists of multiple people.

A Red Team Assessment does not look for multiple vulnerabilities but for those vulnerabilities that will achieve their goals. The goals are often the same as the Penetration Test. Methods used during a Red Team Assessment include Social Engineering (Physical and Electronic), Wireless, External, and more. A Red Team Assessment is NOT for everyone though and should be performed by organizations with mature security programs. These are organizations that often have penetration tests done, have patched most vulnerabilities, and have generally positive penetration test results.

The Red Team Assessment might consist of the following:

A member of the Red Team poses as a Fed-Ex delivery driver and accesses the building. Once inside, the Team member plants a device on the network for easy remote access. This device tunnels out using a common port allowed outbound, such as port 80, 443, or 53 (HTTP, HTTPS, or DNS), and establishes a command and control (C2) channel to the Red Team's servers. Another Team member picks up the C2 channel and pivots around the network, possibly using insecure printers or other devices that will take the sights off the device placed. The Team members then pivot around the network until they reach their goal, taking their time to avoid detection.

This is just one of innumerable methods a Red Team may operate but is a good example of some tests we have performed.

==== Blue Team Assessment
Blue team assessment is usually a test of the teams' ability to identify and defend the network while under attack by the Red Teams/Penetration Tester/Hacker.

==== Methods
social engineering, phishing, vishing or simply posing as a company employee.

=== Threat Modeling
Threat modeling is a process by which potential threats, such as structural vulnerabilities can be identified, enumerated, and prioritized – all from a hypothetical attacker’s point of view. The purpose of threat modeling is to provide defenders with a systematic analysis of the probable attacker’s profile, the most likely attack vectors, and the assets most desired by an attacker. Threat modeling answers the questions “Where are the high-value assets?” “Where am I most vulnerable to attack?” “What are the most relevant threats?” “Is there an attack vector that might go unnoticed?

It is a structured approach that enables you to identify, quantify, and address the security risks associated with an application. Threat modeling is not an approach to reviewing code, but it does complement the security code review process.

==== CVSS
CVSS stands for Common Vulnerability Scoring System, which provides a score to indicate the severity of the CVE vulnerabilities.

Assignment of a CVSS score is based on:

* The primary impact on the confidentiality, integrity, and availability of the protected system/resources
* The derivative impact on loss of life and/or properties
* The percentage of the impacted area within the total environment
* How easy it is to exploit the vulnerability
* How easy it is to remediate the vulnerability
* How confident the testing team is about the existence of the vulnerability

==== NVD
National Vulnerability Database (NVD) is the U.S. government repository of standards based vulnerability management data. NVD also provides severity rankings of "Low," "Medium," and "High" in addition to the numeric CVSS scores. These qualitative rankings are simply mapped from the numeric CVSS scores:

* Vulnerabilities are labeled "Low" severity if they have a CVSS base score of 0.0-3.9.
* Vulnerabilities will be labeled "Medium" severity if they have a base CVSS score of 4.0-6.9.
* Vulnerabilities will be labeled "High" severity if they have a CVSS base score of 7.0-10.0.

==== STRIDE
STRIDE is a model of threats developed by Praerit Garg and Loren Kohnfelder at Microsoft[1] for identifying computer security threats.[2] It provides a mnemonic for security threats in six categories.[3]

The threats are:

* **S**poofing of user identity
* **T**ampering
* **R**epudiation
* **I**nformation disclosure (privacy breach or data leak)
* **D**enial of service (D.o.S)
* **E**levation of privilege.

==== DREAD
DREAD methodology is used to rate, compare and prioritize the severity of risk presented by each threat that is classified using STRIDE.

* **D**amage
* **R**eproducibility
* **E**xploitability
* **A**ffected Users
* **D**iscoverability

DREAD Risk = (Damage + Reproduciblity + Exploitability + Affected Users + Discoverability) / 5. Calculation always produces a number between 0 and 10. Higher the number means more serious the risk is.

Following is a customized mathematical approach to implement DREAD methodology:-

*Damage Potential*
If a threat exploit occurs, how much damage will be caused?

* 0 = Nothing
* 5 = Information disclosure that could be used in combination with other vulnerabilities
* 8 = Individual/employer non sensitive user data is compromised.
* 9 = Administrative non sensitive data is compromised.
* 10 = Complete system or data destruction.
* 10 = Application unavailability.

*Reproducible*
How easy is it to reproduce the threat exploit?

* 0 = Very hard or impossible, even for administrators of the application.
* 5 = Complex steps are required for authorized user.
* 7.5 = Easy steps for Authenticated user
* 10 = Just a web browser and the address bar is sufficient, without authentication.

*Exploit-ability*
What is needed to exploit this threat?

* 2.5 = Advanced programming and networking knowledge, with custom or advanced attack tools.
* 5 = Exploit exits in public, using available attack tools.
* 9 = A Web Application Proxy tool
* 10 = Just a web browser

*Affected Users*
How many users will be affected?

* 0 = None
* 2.5 individual/employer that is already compromised.
* 6 = some users of individual or employer privileges, but not all.
* 8 = Administrative users
* 10 = All users

*Discover-ability*
How easy is it to discover this threat?

* 0 = Very hard requires source code or administrative access.
* 5 = Can figure it out by monitoring and manipulating HTTP requests
* 8 = Details of faults like this are already in the public domain and can be easily discovered using a search engine.
* 10 = the information is visible in the web browser address bar or in a form.

DREAD methodology can be customized to cater the needs of your application, during consultancy engagements it should be approved from the client before starting the security assessment so that after you perform the analysis the results produced by DREAD couldn’t be challenged.

=== Threat Intelligence

==== MITRE ATT&CK
MITRE ATT&CK™ is a globally-accessible knowledge base of adversary tactics and techniques based on real-world observations. The ATT&CK knowledge base is used as a foundation for the development of specific threat models and methodologies in the private sector, in government, and in the cyber security product and service community.

With the creation of ATT&CK, MITRE is fulfilling its mission to solve problems for a safer world — by bringing communities together to develop more effective cybersecurity. ATT&CK is open and available to any person or organization for use at no charge.

MITRE ATT&CK website: https://attack.mitre.org/ 

==== Palo Alto Unit42
Unit 42 is the global threat intelligence team at Palo Alto Networks®

.. Palo Alto Unit42 website: https://unit42.paloaltonetworks.com/ 
.. Playbook: https://pan-unit42.github.io/playbook_viewer/ 

https://www.packetstormsecurity.com
https://www.securityfocus.com
https://www.exploit-db.com

==== STIX
STIX (Structured Threat Information eXpression) was originally conceived as a language to describe cyber threat intelligence. This was groundbreaking at the time because it was the first language to provide a definition of cyber threat intelligence. Although it’s a bit of a fuzzy term, cyber threat intelligence generally describes information about adversaries and their behaviors that can inform defensive actions. For example, knowing that a certain adversary targets financial institutions by using specially crafted spear-phishing emails, and then delivers Trojans that will reach out to a certain set of websites that are known to be malicious, can be very helpful in defending against the attack. STIX captures that type of intelligence in a machine-readable form so that it can be shared among organizations and tools.

The DHS Office of Cybersecurity and Communications funded MITRE, beginning in 2012, to act as the technical developer of STIX and serve as a community facilitator to jumpstart STIX. Once some level of maturity was reached, STIX would be transitioned to an international standards body. That goal was realized in 2015 when governance of STIX was transitioned to OASIS, an international standards consortium. This was a big step for STIX and a big success for DHS, MITRE, and the community because it meant that STIX was on its way to becoming an international standard. Although DHS and MITRE continue to serve in several leadership positions in the CTI TC, the majority of the leadership and the vast majority of participants in the TC are from industry. In fact, the OASIS CTI TC was founded with more participants than any other TC in OASIS history. It's that community that led the development of STIX 2.0.

==== TAXII
TAXII is a high-level protocol for moving cyber threat intelligence (primarily STIX) data around between systems and tools. We expect that, within the coming months, TAXII will be achieving this same milestone and opening its own public review period.

If you're interested in learning more about STIX 2.0 or TAXII 2.0, the documentation page is the best place to start.

=== Threat Risk Assessments
Threat: Any potential actor that has the capability, motivation, or intent to exploit a vulnerability.
Vulnerability: Is a weakness that allows a threat to compromise the security of a system.
Risk: Likelihood of a threat source to exploit a vulnerability to target a critical asset and impact a business negatively.
Controls, safeguards, countermeasures are implemented to reduce the risk.


=== Threat Hunting
Threat hunting is a relatively new focal area in information security.


<<<
== Enterprise Architecture
Source: https://www.youtube.com/watch?v=NUD-LXUE4tM 

*Enterprise* is any organization that is large or small with a collaborative collection of sub-organizations with a shared set of objectives.

*Architecture* is a designed structure of something.  A description of the structure (components) and behaviors (Processes) of a system.  It is also an activity required to produce such a description.

*Enterprise Architecture* is documentation describing the structure and behaviour of an enterprise including its information systems.  Also a process for describing an enterprise(including its information systems), then planning and governing changes to improve the integrity and flexibility of the enterprise.

Frameworks provide guidelines on how to implement enterprise architecture.  Frameworks address following areas:
* Content (strcuture, metamodel)
* Process (activities)
* Organization (roles, people)

Some of the frameworks are:

* TOGAF (covers all three, content, process, and organization)
* Zachman (Purely covers content)
* SABSA
* DODAF
* MODAF

Large organizations are complex, hence they can be broken down into following typical domains

. Business (Why organization exisit, objectives, goals, strategic thinking, capabilities, processes, functions, organizatinal structure)
. Data
. Application(s)
. Technology

Following domains cut across the typical domains:

. Security
. Compliance


*Architecture Activities* typically when you are performing any sort of change, you have to document the current state and future state.  This represents the strategic vision of the organization, where they want to be in 3-5 years time.

Enterprise architecture is about overseeing these changes by defining various architecture principles and standards.  Architects then govern those changes to ensure that the standards and principles are being followed.

=== SABSA
SABSA is a framework that supports the business in reaching its goals.  It is the leading methodology for developing business operational risk-based architectures.  SABSA stands for Sherwood Applied Business Security Architecture.

It provides a framework for developing risk driven enterprise information security and information assurance architectures.

It also helps to deliver security infrastructure solutions that help critical business initiatives.

The SABSA methodology provides guidance for aligning architecture with business value, it also addresses a critical need for greater integration between security and enterprise architecture within organizations.

With SABASA organizations can achieve that important risk reward balance using a range of frameworks, models, methods, and process to manage risk and measure performance.

The SABSA model is the key to this and covers the whole lifecycle of operational capabilities.  The SABSA model has six layers:

. Contextual Architecture: The Business View (Business wisdom and business decision making)
. Conceptual Architecture: The Architect's vision (The 'big picture', business attributes profiel and risk objectives)
. Logical Architecture: The Designers Vision (Information, services, processes, applications)
. Physical Architecture: The builders/constructors view(Data mechanisms, infrastructure, platforms)
. Component Architecture: The Trademan's View (Products, Tools, Specific Standards, Technologies)
. Security Services Management Architecture: The Service Manager's view (Service management activities, processes and monitoring)

Each of the layers of the architecture model are supported by a vertical analysis based on six key questions

* What
* Why
* How
* Who
* Where
* When

The SABSA framework is flexible, scalable and applicable to any industry sector.  Instead of replacing other risk based standards, it can be combined with TOGAF, COBIT and ITIL to create an integrated compliance framework.

SABSA provides organization with "enterprise operational risk management architecture" that can be completely tailored to a specific business model. 

SABSA's governance model provide a control feedback loop

. Strategy & Planning
. Design
. Implement
. Management & Measure

<<<
== NIST Cyber Security Framework(CSF)
Key functions are

. Identify
. Protect
. Detect
. Respond
. Recover

Top two are proactive measures, and bottom three are reactive measures.

<<<
== Security Architecture

=== Network Architecture

=== Application Architecture

=== System Architecture

<<<
== Dev, Sec, Ops
Development, Operations, and Security operate as silos. 

*CiCd* or Continuous Integration and Continuous Delivery is key for *DevSecOps*

image::knowyourapplication.png[title="Know your application"]

Some activities to consider for DevSecOps:

* Threat Modeling
* Attack Surface Evaluation
* Static & dynamic code analysis
* Penetration Testing
* Security Code Reviews
* Fuzz Testing

Teams who are considering DevSecOps should think about:

* Frameworks & Tools
* Automating core security tasks
* Embedding securit controls and processes

Five principles for Securing DevOps

* Automate Security In
* Integration to fail quickly
* No false Alarm
* Build Security Champions
* Keep Operational Visibility



=== OWASP Top 10 App Sec Risks

. Injection
. Broken Authentication
. Sensitive Data Exposure
. XML External Exposures (XXE)
. Broken Access Control
. Security Misconfiguration
. Cross Site Scripting
. Insecure Deserialization
. Using component with known vulnerabilities
. Insufficient Logging/Monitoring

=== Real-Word Top 10 Attacks
. Direct Object Reference
. Forceful Browsing
. Null Byte Attack
. Command Injection
. Feature Abuse
. Evasion Techniques
. Subdomin Takeover
. Misconfiguration
. Cross Site Scription
. SQL Injection 

<<<
== Governance, Risk, & Compliance
A documented process must be followed to ensure compliance to security policy and to highlight risks that might be introduced when security policy requirements are not adhered to.  Some of the GRC functions are:

* Enterprise Risk Management
* IT Risk Management
* Integrated Risk Management
* Operational Risk Management
* Compliance
* Enterprise GRC Management
* Vendor/Third-Party Risk Management
* Business Continuity
* Financial Audit

=== Enterprise Risk Management

* Not necessarily covered by insurance
* Multi-dimensional assessment
* Analyzes material risks and how they relate
* Spans the entire organization ("holistic")
* Proactive & continuous
* Considers both upside and downside
* Focuses on business goals, adding value and more
* Embedded in culture and mindset 


<<<
== Terms Used

* ATT&CK - Adversatial Tactics Techniques & Common Knowledge
* CTI - Cyber Threat Intelligence
* IOC - Indicators of Compromise
* OSINT - Open Source Inteligence Tools
* TTP - Techniques, Tactics, Procedures

<<<
[bibliography]
== References
. Writing Position Papers: http://www.studygs.net/wrtstr9.htm 
. Cover Page graphic: https://www.pinterest.com/pin/352758583290504850/ 
. What is Malware? https://www.avg.com/en/signal/what-is-malware



